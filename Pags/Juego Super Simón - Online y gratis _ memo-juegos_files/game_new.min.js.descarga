!function(V){V.fn.game=function(a,c,t){var e="click",r=!1,l=t,g=l.length,u="2%";V("#game_full_width").attr("posymsg")&&(u=V("#game_full_width").attr("posymsg"));var h="#19d6e7";V("#game_full_width").attr("colorscore")&&(h=V("#game_full_width").attr("colorscore"));var m="#ffffff";V("#game_full_width").attr("colormsg")&&(m=V("#game_full_width").attr("colormsg"));var d="rgba(0,0,0,0.8)";V("#game_full_width").attr("bgscore")&&(d=V("#game_full_width").attr("bgscore"));var _="#596d7d";V("#game_full_width").attr("bgsettings")&&(_=V("#game_full_width").attr("bgsettings"));var f="#ffffff";V("#game_full_width").attr("colorspeed")&&(f=V("#game_full_width").attr("colorspeed"));var b="#19d6e7";V("#game_full_width").attr("bgbuttons")&&(b=V("#game_full_width").attr("bgbuttons"));var v="rgba(255,255,255,0.3)";V("#game_full_width").attr("blackscreen")&&(v=V("#game_full_width").attr("blackscreen"));var o=new Array,n=new Array,w=0,p=0,y=!1,k=!1,i=!0,s=0,x=0,T=0,S=1e3;V("#game").css({"max-width":a.toString()+"px"});for(var A=0,I=800,C=100,D=500,G=400,P=new Array(800,800,300,100),z=new Array(500,500,300,300),F=200,M="PLAY!",H="WATCH!",M="JUGAR!",H="MIRAR!",R=new Object,j=0;j<g;j++)R[j.toString()]=[l[j].sound_start,l[j].sound_duration];var E=g.toString();R[E]=[90,200],gSoundFiles||alert("no sound file");var O=new Howl({src:gSoundFiles,sprite:R});gSoundEndFiles||alert("no end sound file");var U=new Howl({src:gSoundEndFiles,sprite:{gameover:[140,970]}});function B(t,e,o){var n;n=o?((n=new Date).setTime(n.getTime()+24*o*60*60*1e3),"; expire="+n.toGMTString()):"",document.cookie=t+"="+e+n+"; path=/"}function J(){var s="";setTimeout(function(){for(var t=0;t<g;t++){var e=100*l[t].width/a,o=100*l[t].x/a,n=100*l[t].y/c;s+='<div class="case hand" ball="'+(t+1)+'" style="position:absolute;display:block;top:'+n+"%;left:"+o+"%;width:"+e+'%;"><img src="'+gBaseUrl+l[t].img1+'" class="img_on" style="display:block;visibility:hidden;width:100%"/></div>'}V(s+='<div id="generic_game_msg" style="display:none;position:absolute;text-align:center;font-weight:bold;color:'+m+";width:70%;left:15%;top:"+u+'">'+H+"</div>").appendTo("#game"),V("#game_settings_int").css({"background-color":_}),V("#score_game").css({"background-color":d,color:f}),V(".score,.high_score").css({color:h}),V(".game_mode_button").addClass(b);var i=c*V("#main_image").width()/a;V("#black_screen").css({"background-color":v}).show(),V("#game,#black_screen").css({height:i+"px"}),V("#level_buttons div").first().addClass("active_level"),L("#bt_start"),V("#level_buttons div").each(function(){V(this).on("touchstart",function(){r=!0}),V(this).on("touchmove",function(){r=!1}),V(this).off().on("click touchend",function(t){"click"==t.type&&(r=!0),r&&(t.preventDefault(),t.stopPropagation(),y=!0,p<w&&(p=w,B("memozor-simon-score-"+gIdGame,p,365)),V("#score_game .high_score").text(p),V("#level_buttons div").removeClass("active_level"),V(this).addClass("active_level"),A=parseInt(V(this).attr("level")),Q(),V("#black_screen").show(),V("#generic_game_msg").hide(),K(),V("#bt_result").hide(),L("#bt_start")),r=!1})}),k?(V("#btn_mute").show(),V("#btn_sound").hide()):(V("#btn_mute").hide(),V("#btn_sound").show()),V("#btn_sound").show(),V(".change_mute").on("touchstart",function(){r=!0}),V(".change_mute").on("touchmove",function(){r=!1}),V(".change_mute").off().on("click touchend",function(t){"click"==t.type&&(r=!0),r&&(t.preventDefault(),t.stopPropagation(),0==k?(k=!0,V("#btn_mute").show(),V("#btn_sound").hide()):(k=!1,V("#btn_mute").hide(),V("#btn_sound").show())),r=!1}),V("#score_game .high_score").text(p)},200)}function L(e){V("#black_screen").show(),V(e).show().on("touchstart",function(){r=!0}),V(e).show().on("touchmove",function(){r=!1}),V(e).show().off().on("click touchend",function(t){"click"==t.type&&(r=!0),r&&(t.preventDefault(),t.stopPropagation(),i&&(O.play(E),i=!1),V("#black_screen").hide(),V(e).hide(),V("#score_game .score").text("0"),V("#generic_game_msg").text(H),V("#generic_game_msg").show(),y=!1,setTimeout(function(){W()},S)),r=!1})}function Q(){V(".case").each(function(){V(this).off()})}function W(){Q();var t=Math.floor(Math.random()*g)+1;o[s]=t,s++,Y(o[T=0])}function Y(t){var e=(parseInt(t)-1).toString();V(".case[ball="+t+"]").find(".img_on").css({visibility:"visible"}),k||O.play(e),setTimeout(function(){V(".case[ball="+t+"]").find(".img_on").css({visibility:"hidden"}),T++,V("#generic_game_msg").text(H),y||(T<o.length?setTimeout(function(){Y(o[T])},I):(x=0,n.splice(0,n.length),V("#generic_game_msg").text(M),q()))},D)}function q(){V(".case").each(function(){V(this).on("touchstart",function(t){e="touchstart",r=!0}),V(this).on("touchmove",function(t){r=!1}),V(this).off().on(e,function(t){var e;"click"==t.type&&(r=!0),r&&(t.preventDefault(),t.stopPropagation(),e=V(this).attr("ball"),t=(parseInt(e)-1).toString(),n[x]=e,x++,V(".case").off(),V(".case[ball="+e+"]").find(".img_on").css({visibility:"visible"}),k||O.play(t),setTimeout(function(){V(".case[ball="+e+"]").find(".img_on").css({visibility:"hidden"}),n[x-1]==o[x-1]?n.length==o.length?(w++,V("#score_game .score").text(w),V(".img_on").css({visibility:"hidden"}),V("#generic_game_msg").text(H),0==A&&C<=I&&(I-=100,G<=D&&(D-=14)),setTimeout(function(){W()},1e3)):q():(k||U.play("gameover"),Q(),p<w&&(p=w,B("memozor-simon-score-"+gIdGame,p,365)),V("#score_game .high_score").text(p),V("#black_screen").show(),V("#generic_game_msg").hide(),K(),L("#bt_result"))},F)),r=!1})})}function K(){n.splice(0,n.length),o.splice(0,o.length),T=x=s=w=0,I=P[A],D=z[A]}function N(){var t=c*V("#main_image").width()/a;V("#game,#black_screen").css({height:t+"px"})}t=function(t){for(var e=t+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var i=o[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return null}("memozor-simon-score-"+gIdGame);t&&(p=t),function(){J();var t=c*V("#main_image").width()/a;V("#game,#black_screen").css({height:t+"px"})}(),setTimeout(function(){N()},100),V(window).resize(N)}}(jQuery);